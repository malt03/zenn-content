---
title: "Goè¨€èªã«ãŠã‘ã‚‹ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹"
emoji: "ğŸ˜º"
type: "tech"
topics:
  - "go"
  - "error"
published: true
---

ã‚‚ã†æ•£ã€…æ›¸ã‹ã‚Œã¦ã„ã‚‹è©±ã ã‘ã©ã€Go ã«è§¦ã‚‹ãŸã³ã«æ¯å›èª¿ã¹ç›´ã™ç¾½ç›®ã«ãªã£ã¦ã„ã‚‹ã®ã§ã€å¿˜å‚™éŒ²ã¨ã—ã¦ã¾ã¨ã‚ã¦ãŠã

# çµè«–

- `errors` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ä½¿ã‚ãªã„
- ãã®ä»£ã‚ã‚Šã« `golang.org/x/xerrors` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã†
- ã‚¨ãƒ©ãƒ¼ã‚’è‡ªåˆ†ã§ä½œæˆã™ã‚‹ã¨ãã¯ `xerrors.New` ã‚‚ã—ãã¯ `xerrors.Errorf` ã‚’ä½¿ã†
- é–¢æ•°ã‹ã‚‰å—ã‘å–ã£ãŸã‚¨ãƒ©ãƒ¼ã‚’è¿”ã™ã¨ãã¯ `xerrors.Errorf(": %w", err)` ã‚’ä½¿ã†
  - ã‚³ãƒ¡ãƒ³ãƒˆã‚’ä»˜ä¸ã—ãŸã„ã¨ãã¯ `xerrors.Errorf("comment: %w", err)`
- ã‚¨ãƒ©ãƒ¼ã®å‡ºåŠ›ã¯ `fmt.Printf("%+v\n", xerrors.Errorf(": %w", err))` ã“ã‚“ãªæ„Ÿã˜

## å…·ä½“ä¾‹

```go
package main

import (
	"fmt"
	"os"
	"strconv"

	"golang.org/x/xerrors"
)

func main() {
	if err := f(os.Args[1]); err != nil {
		fmt.Printf("%+v\n", xerrors.Errorf(": %w", err))
	}
}

func f(s string) error {
	n, err := strconv.Atoi(s)
	if err != nil {
		return xerrors.Errorf(": %w", err)
	}
	if n < 10 {
		return xerrors.Errorf("n is %d", n)
	}
	return nil
}
```

# èª¬æ˜

- æ¨™æº–ã® `errors` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã†ã¨ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãŒå–ã‚Œãšã€ã©ã“ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸã®ã‹å…¨ãã‚ã‹ã‚‰ãªã„ã®ã§ã€ä½•ã‚‰ã‹ã®æ‰‹æ®µã‚’ç”¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ãã®ä¸€ç•ªå¦¥å½“ãªé¸æŠè‚¢ãŒ `golang.org/x/xerrors` ã€‚
- API ã¯ `github.com/pkg/errors` ã®æ–¹ãŒå¥½ã¿ã ã‘ã©ã™ã§ã«ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã•ã‚Œã¦ãŠã‚Šã€ä»Šå¾Œãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã•ã‚Œãªã„è¦‹è¾¼ã¿ãªã®ã§ä½¿ã‚ãªã„ã€‚
  - `xerrors` ã‚‚å…¨ç„¶ã‚³ãƒŸãƒƒãƒˆã•ã‚Œã¦ã„ãªã„ã‘ã©ã€ `This package is based on the Go 2 proposal` ã¨æ›¸ã„ã¦ã‚ã‚Šã€Go è¨€èªã®ãƒ¡ã‚¤ãƒ³ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®å®Ÿè£…ã¨è¨€ãˆãã†ã ã—ç‰¹ã«ãƒã‚°ã‚‚ç„¡ã•ãã†ãªã®ã§ã€è‰¯ã„æ„å‘³ã§å®‰å®šã—ã¦ã„ã‚‹ã®ã‹ã‚‚ã€‚
- `xerrors.Errorf` ã¯å®Ÿè¡Œã—ãŸé–¢æ•°ã®ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ã¨ã£ã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªãã€ã‚ãã¾ã§ `Errorf` ã‚’å®Ÿè¡Œã—ãŸä½ç½®ã‚’ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã«è¿½åŠ ã—ã¦ã„ãã ã‘ã£ã½ã„ã®ã§ã¡ã‚‡ã£ã¨ä½¿ã„ã¥ã‚‰ã„ã€‚å‡ºåŠ›æ™‚ã«ã‚‚ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ä»˜ä¸ã—ãŸæ–¹ãŒã„ã„ã€‚
- `xerrors.Errorf("%w", err)` ã¨ `: ` ã‚’æ›¸ã‹ãšã«ãƒ©ãƒƒãƒ—ã™ã‚‹ã¨ã€å—ã‘å–ã£ãŸã‚¨ãƒ©ãƒ¼ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å‹æ‰‹ã«ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦ä»˜ä¸ã—ã¦ã—ã¾ã„ã€ã¨ã¦ã‚‚ã¿ã¥ã‚‰ã„ã“ã¨ã«ãªã‚‹ã€‚
